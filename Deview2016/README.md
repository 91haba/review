# Deview 2016

## LAVISS 개발
매일 수억건의 검색쿼리에 대한 모니터링 시스템

### 시스템 시각화는 최대한 알고리즘으로 그리자

* 그래프를 그리는데 너무나 많은 시간이 걸려 결과 화면을 캐시하도록 변경
* Force directed layout
  - 원하는 레이아웃이 안나옴
  - 특히 여러 검색 결과를 통합하는 서버에서 노드들의 위치가 올바르지 않았음
  - 추가로 하위의

* 직접 알고리즘 만듬 - NAVERTIC layout
  - 데이터는 그래프인데 트리 그리는 알고리즘으로 어떻게 그리나?
    - 그래프를 트리 구조로 바꾸는 변환함수를 구현

### 히스토리 관리


### UX 가이드
* 카메라와의 포지션과 앵글이 가장 많은 고민이 필요
  - 사람의 시선에 따라 가까운 사물/먼 사물을 볼때가 다름
  - 2개의 sin함수로 해결


## QUIC을 이용한 네트워크 성능 개선
라인 쿠키런을 출시하면서 네트워크 끊김에 대한 CS가 계속 들어옴<br/>
한국의 모바일망과 해외의 모바일망의 차이가 존재함 <br/>

### 모바일 게임의 일반적인 구조
* 모바일 -> LB -> 클라우드 서비스
  - LB에서 클라우드 사이는 신뢰가능한 구간
  - 반명 모바일기기 -> LB 구간은 블랙박스구간

* HTTP/1.1
  - 헤더가 로스되면 그 뒤가 다 로스되는 이슈 있음
  - 헤더는 zip되어 있지 않다.

* SPDY & HTTP2
  - 스트림을 멀티플렉스해서 로스 최소화

* 그러나 모바일은?
  - TCP가 문제라서 사이트마다 효과가 다름

* TCP + TLS
  - 헤더로스 문제
  - 3G + 와이파이로 이동이 너무나 잦은 모바일 환경에서의 패킷로스
  - 4.5 회의 이동이 필요함
  - slow start
  - 미들박스와 OS커널의 수정없이 고쳐야한다는 가장 큰 문제

### QUIC?
* Quick UDP Internet Connections
* 구글의 목표
  - 현재 바로 적용가능해야함
  - Latency를 개선
  - HOL 문제 해결

* 장점
  - Multiple stream
  - 0~1 RTT
  - connection stablish (3g <-> 와이파이 커넥션 유지)

### 실제서비스에 적용하기
* Chromium Project 에 프로토타이핑 해보자
  - 의존성 지옥을 만남
  - 포기
* libquic / goquic
* 현재 알려진 서버 구현체
  - GoQuic
  - Caddy
  - 구글 앱엔진을 사용하면 바로 이용 가능

* 클라이언트
  - Cronet
    - ICS 이하 기기 지원, ARMv6기기 지원 x
    - 특정 플랫폼에서 크래시 나는 경우가 종종 있음
  - CrNet
    - obj-c ARC 사용하지 않으므로 MRR 변경 필수
  - static library 빌드와 실제 app 빌드시 파라미터 맞추는 작업 필요

* chrome http/2 & spdy indicator 플러그인 추천

### 결과
* 하위 5% 유저기준
* HTTP1:1초이상 유저 5%이상, HTTP2 : 그 절반, QUIC : 거의 없음

### Q&A
* 왜 CPU 성능이 많이 필요한지?
  - RPS를 측정해보니 가장먼저 튀는게 CPU였음
  - QUIC 자체가 처리양이 많다
  - 대용량 데이터보다는 작은 데이터를 여러번 받을때 더 좋을것 같다
  - 유투부는 QUIC을 통해 큰 효과를 보고 있다.
* 안드로이드 문제가 너무 많은데 어떻게 해결했는지
  - stable 버전을 쫓아가면서 했음
  - 유저가 특정 행위를 할때 크래시가 났엇음
  - 안드로이드 적용은 정말 꼼꼼한 테스트 필요
* 1.1 -> 2로 전환하면서 했던 작업은?
  - Cronet, CrNet에서 자동 지원해서 별도로 작업은 하지 않아음
  - 클라이언트를 2용으로 만들진 않았음
  -

## 나만의 성능 모니터링 시스템 만들기
### BCI
bytecode에 직접 변경을 가해 소스코드의 수정없이 원하는 기능을 삽입할 수 있는 방법 <br/>

* premain()만 기억하자
  - main() 전에 수행된다
  - 여기서 transformer를 통해 class 변경

* scouter plugin


##

### Neutron
